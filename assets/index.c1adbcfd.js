import{u as h,r as m,o as T,c as E,a as S,j as y,b as O,d as g,e as v,f as A}from"./vendor.2023f16f.js";const C=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}};C();const R={setup(e){const t=h();return document.getElementById("app").addEventListener("click",()=>t.dispatch("setSelect",!1)),(o,r)=>{const s=m("router-view");return T(),E(s)}}},I="modulepreload",_={},L="/cats-on-the-bus/",u=function(t,n){return!n||n.length===0?t():Promise.all(n.map(o=>{if(o=`${L}${o}`,o in _)return;_[o]=!0;const r=o.endsWith(".css"),s=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${s}`))return;const a=document.createElement("link");if(a.rel=r?"stylesheet":I,r||(a.as="script",a.crossOrigin=""),a.href=o,document.head.appendChild(a),r)return new Promise((p,i)=>{a.addEventListener("load",p),a.addEventListener("error",i)})})).then(()=>t())},c=S.create({});function N(){let e="e3c094ff4237499c94407751d39cef1a",t="1VHLF8NU_sKTMF88LeGX5V4yb3I",n=new Date().toGMTString(),o=new y("SHA-1","TEXT");o.setHMACKey(t,"TEXT"),o.update("x-date: "+n);let r=o.getHMAC("B64");return{Authorization:'hmac username="'+e+'", algorithm="hmac-sha1", headers="x-date", signature="'+r+'"',"X-Date":n}}c.interceptors.request.use(e=>(e.headers.Authorization=N(),e),e=>(console.error("Axios request error: "+e),Promise.resolve(e)));c.interceptors.response.use(e=>e.data,e=>(console.log("catch errrrrrr"),console.error("Axios response error: "+e),Promise.resolve(e)));function B(e){return c({url:`https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/${e}?$format=JSON`,method:"get"})}function b(e){console.log(e);const t={$format:"JSON",$filter:`RouteUID eq '${e.route.RouteUID}'`,$orderby:"StopSequence asc"};return c({url:`https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/City/${e.city}`,method:"get",params:t})}function w(e){console.log(e.route.name);const t={$format:"JSON"};return c({url:`https://ptx.transportdata.tw/MOTC/v2/Bus/StopOfRoute/City/${e.city}/${e.route.name}`,method:"get",params:t})}function $(e){const t={$format:"JSON",$top:30,$spatialFilter:`nearby(${e}, 500)`};return console.log(t),c({url:"https://ptx.transportdata.tw/MOTC/v2/Bus/Stop/NearBy",method:"get",params:t})}var d=O({state:{path:"",openSelect:!1,currentCity:{},allBus:[],routeData:[],stopInfo:{},location:[],currentRoute:{}},mutations:{SET_PATH(e,t){e.path=t},SET_CITY(e,t){e.currentCity=t},SET_BUS(e,t){e.allBus=t},SET_ROUTE(e,t){e.routeData=t},SET_STOP_INFO(e,t){e.stopInfo=t},SET_SELECT(e,t){e.openSelect=t},SET_LOCATION(e,t){e.location=t},SET_CURRENT_ROUTE(e,t){e.currentRoute=t}},actions:{setPath({commit:e},t){e("SET_PATH",t)},setSelect({commit:e},t){e("SET_SELECT",t)},setLocation({commit:e},t){e("SET_LOCATION",t)},async getAllBus({state:e,commit:t},n){t("SET_CITY",n);const o=await B(n.City);o.forEach(r=>r.name=r.RouteName.Zh_tw),t("SET_BUS",o)},async getRoute({state:e,commit:t},n){const o={city:e.currentCity.City,route:n},r=await b(o),s=await w(o),a={};s.forEach(i=>{i.Direction===0?a.forward=[...i.Stops]:a.backward=[...i.Stops]});const p=Date.now();r.forEach(i=>{i.EstimateTime===0?i.arrival=i.EstimateTime:i.arrival=i.EstimateTime/60||Math.round((Date.parse(i.NextBusTime)-p)/1e3/60)}),t("SET_CURRENT_ROUTE",n),t("SET_ROUTE",r),t("SET_STOP_INFO",a)},resetRoute({commit:e}){e("SET_LOCATION",[]),e("SET_CURRENT_ROUTE",[])}}});const f=g({history:v(),scrollBehavior(){return{top:0}},routes:[,{path:"/",component:()=>u(()=>import("./Home.5cc47451.js"),["assets/Home.5cc47451.js","assets/Home.004e87f0.css","assets/sidebar-stop.e10da5a1.js","assets/vendor.2023f16f.js","assets/plugin-vue_export-helper.5a098b48.js"])},{path:"/",component:()=>u(()=>import("./HelloWorld.5f754c64.js"),["assets/HelloWorld.5f754c64.js","assets/HelloWorld.47fa80c6.css","assets/vendor.2023f16f.js","assets/sidebar-stop.e10da5a1.js","assets/plugin-vue_export-helper.5a098b48.js"]),children:[{path:"bus_search",component:()=>u(()=>import("./BusSearch.593a569b.js"),["assets/BusSearch.593a569b.js","assets/BusSearch.894c6211.css","assets/vendor.2023f16f.js","assets/plugin-vue_export-helper.5a098b48.js"])},{path:"nearby_stop",component:()=>u(()=>import("./NearbyStop.d49d2e29.js"),["assets/NearbyStop.d49d2e29.js","assets/NearbyStop.52d5e840.css","assets/locate.37e8aff3.js","assets/vendor.2023f16f.js","assets/plugin-vue_export-helper.5a098b48.js"])},{path:"route_search",component:()=>u(()=>import("./RouteSearch.1b82d895.js"),["assets/RouteSearch.1b82d895.js","assets/RouteSearch.9a837b38.css","assets/locate.37e8aff3.js","assets/plugin-vue_export-helper.5a098b48.js","assets/vendor.2023f16f.js"])}]}]});f.beforeEach(async(e,t,n)=>{d.dispatch("setPath",e.path),n()});const l=A(R);l.use(f);l.use(d);console.log("set up!",l);l.mount("#app");export{$ as g};
